
# ğŸš€ Strapi CMS Deployment on AWS ECS using Terraform

This project automates the secure, scalable, and cost-optimized deployment of a Strapi CMS backend on AWS using ECS Fargate with Terraform.

---

## ğŸ“¦ Features

- ğŸ“Œ **Strapi deployed on ECS Fargate** (On-Demand + Spot capacity providers)
- ğŸ”’ Private Subnet configuration for enhanced security
- ğŸ” Auto-scalable, load-balanced infrastructure using ALB
- ğŸ“‰ Cost optimization via scheduled ECS cleanup using Lambda + CloudWatch
- ğŸ§  CloudWatch monitoring and threshold-based alerts
- ğŸ” IAM roles and security groups managed via Terraform
- âœ… Fully modular and reproducible infrastructure-as-code setup

---

## ğŸ—‚ï¸ Folder Structure

Deployment_infra/
â”œâ”€â”€ Networking/ # VPC, Subnets, NAT Gateway, Route Tables
â”œâ”€â”€ Security/ # Security groups and rules
â”œâ”€â”€ ECS/ # Task definition, ECS cluster, ECS service
â”œâ”€â”€ IAM/ # IAM roles and policies for ECS and Lambda
â”œâ”€â”€ Lambda/ # Cleanup Lambda + trigger config
â”œâ”€â”€ cloudwatch/ # Monitoring & alarms
â”œâ”€â”€ main.tf # Module composition
â”œâ”€â”€ variables.tf # Input variables
â””â”€â”€ output.tf # Useful outputs (e.g., ALB DNS)


---

## ğŸ§± Infrastructure Overview

- **Strapi App** runs inside a container on **ECS Fargate**
- ECS Tasks are deployed inside **private subnets**
- **Application Load Balancer (ALB)** sits in public subnets for traffic routing
- **NAT Gateway** enables internet access for private tasks (for pulling Docker images)
- **Lambda Function** scheduled via **CloudWatch Events** performs cleanup of:
  - Stopped ECS tasks
  - Unused services
  - Available ENIs
- **CloudWatch Alarms** trigger alerts for high CPU/memory usage

---

## âœ… Prerequisites

- AWS CLI configured
- Terraform v1.4+
- Docker (for building Strapi image)
- AWS credentials set via environment or profile

---

## âš™ï¸ How to Use

1. **Clone the repo:**

```bash
git clone https://github.com/navigill7/Strapi.git
cd Strapi/Deployment_infra
cd ../strapi
docker build -t <your-dockerhub-username>/strapi:<tag> .
docker push <your-dockerhub-username>/strapi:<tag>
bash

2 Update task definition image tag in ECS module

3 Deploy infrastructure:

```bash
cd ../Deployment_infra
terraform init
terraform apply -auto-approve
bash

ğŸ” ECS Cleanup Lambda (Optional)
This project includes a Lambda function that deletes unused ECS resources:

Runs daily via CloudWatch Event Rule

Logs to CloudWatch Logs

Written in Python and zipped before deployment via Terraform

ğŸ”— Useful Links
Strapi CMS

Terraform AWS Provider Docs

AWS Fargate

ğŸ‘¨â€ğŸ’» Maintainer
Navinder Gill
GitHub: @navigill7



